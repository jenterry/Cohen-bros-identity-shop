{"ast":null,"code":"import _regeneratorRuntime from\"/Users/jenterry/Documents/PM-take-home/Cohen-bros-identity-shop/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/jenterry/Documents/PM-take-home/Cohen-bros-identity-shop/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/jenterry/Documents/PM-take-home/Cohen-bros-identity-shop/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import{CardElement,useStripe,useElements}from\"@stripe/react-stripe-js\";export default function CheckoutForm(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),succeeded=_useState2[0],setSucceeded=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),error=_useState4[0],setError=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),processing=_useState6[0],setProcessing=_useState6[1];var _useState7=useState(true),_useState8=_slicedToArray(_useState7,2),disabled=_useState8[0],setDisabled=_useState8[1];var _useState9=useState(''),_useState10=_slicedToArray(_useState9,2),clientSecret=_useState10[0],setClientSecret=_useState10[1];var stripe=useStripe();var elements=useElements();useEffect(function(){// Create PaymentIntent as soon as the page loads\nwindow.fetch(\"/create-payment-intent\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({items:[{id:\"xl-tshirt\"}]})}).then(function(res){return res.json();}).then(function(data){setClientSecret(data.clientSecret);});},[]);var cardStyle={style:{base:{color:\"#32325d\",fontFamily:'Arial, sans-serif',fontSmoothing:\"antialiased\",fontSize:\"16px\",\"::placeholder\":{color:\"#32325d\"}},invalid:{color:\"#fa755a\",iconColor:\"#fa755a\"}}};var handleChange=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(event){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:// Listen for changes in the CardElement\n// and display any errors as the customer types their card details\nsetDisabled(event.empty);setError(event.error?event.error.message:\"\");case 2:case\"end\":return _context.stop();}}},_callee);}));return function handleChange(_x){return _ref.apply(this,arguments);};}();var handleSubmit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(ev){var payload;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:ev.preventDefault();setProcessing(true);_context2.next=4;return stripe.confirmCardPayment(clientSecret,{payment_method:{card:elements.getElement(CardElement),billing_details:{name:ev.target.name.value}}});case 4:payload=_context2.sent;if(payload.error){setError(\"Payment failed \".concat(payload.error.message));setProcessing(false);}else{setError(null);setProcessing(false);setSucceeded(true);}case 6:case\"end\":return _context2.stop();}}},_callee2);}));return function handleSubmit(_x2){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/React.createElement(\"form\",{id:\"payment-form\",onSubmit:handleSubmit},/*#__PURE__*/React.createElement(CardElement,{id:\"card-element\",options:cardStyle,onChange:handleChange}),/*#__PURE__*/React.createElement(\"button\",{disabled:processing||disabled||succeeded,id:\"submit\"},/*#__PURE__*/React.createElement(\"span\",{id:\"button-text\"},processing?/*#__PURE__*/React.createElement(\"div\",{className:\"spinner\",id:\"spinner\"}):\"Pay\")),error&&/*#__PURE__*/React.createElement(\"div\",{className:\"card-error\",role:\"alert\"},error),/*#__PURE__*/React.createElement(\"p\",{className:succeeded?\"result-message\":\"result-message hidden\"},\"Payment succeeded, see the result in your\",/*#__PURE__*/React.createElement(\"a\",{href:\"https://dashboard.stripe.com/test/payments\"},\" \",\"Stripe dashboard.\"),\" Refresh the page to pay again.\"));}","map":{"version":3,"sources":["/Users/jenterry/Documents/PM-take-home/Cohen-bros-identity-shop/src/CheckoutForm.jsx"],"names":["React","useState","useEffect","CardElement","useStripe","useElements","CheckoutForm","succeeded","setSucceeded","error","setError","processing","setProcessing","disabled","setDisabled","clientSecret","setClientSecret","stripe","elements","window","fetch","method","headers","body","JSON","stringify","items","id","then","res","json","data","cardStyle","style","base","color","fontFamily","fontSmoothing","fontSize","invalid","iconColor","handleChange","event","empty","message","handleSubmit","ev","preventDefault","confirmCardPayment","payment_method","card","getElement","billing_details","name","target","value","payload"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport {\n  CardElement,\n  useStripe,\n  useElements\n} from \"@stripe/react-stripe-js\";\n\nexport default function CheckoutForm() {\n  const [succeeded, setSucceeded] = useState(false);\n  const [error, setError] = useState(null);\n  const [processing, setProcessing] = useState('');\n  const [disabled, setDisabled] = useState(true);\n  const [clientSecret, setClientSecret] = useState('');\n  const stripe = useStripe();\n  const elements = useElements();\n\n  useEffect(() => {\n    // Create PaymentIntent as soon as the page loads\n    window\n      .fetch(\"/create-payment-intent\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify({items: [{ id: \"xl-tshirt\" }]})\n      })\n      .then(res => {\n        return res.json();\n      })\n      .then(data => {\n        setClientSecret(data.clientSecret);\n      });\n  }, []);\n\n  const cardStyle = {\n    style: {\n      base: {\n        color: \"#32325d\",\n        fontFamily: 'Arial, sans-serif',\n        fontSmoothing: \"antialiased\",\n        fontSize: \"16px\",\n        \"::placeholder\": {\n          color: \"#32325d\"\n        }\n      },\n      invalid: {\n        color: \"#fa755a\",\n        iconColor: \"#fa755a\"\n      }\n    }\n  };\n\n  const handleChange = async (event) => {\n    // Listen for changes in the CardElement\n    // and display any errors as the customer types their card details\n    setDisabled(event.empty);\n    setError(event.error ? event.error.message : \"\");\n  };\n\n  const handleSubmit = async ev => {\n    ev.preventDefault();\n    setProcessing(true);\n\n    const payload = await stripe.confirmCardPayment(clientSecret, {\n      payment_method: {\n        card: elements.getElement(CardElement),\n        billing_details: {\n          name: ev.target.name.value\n        }\n      }\n    });\n\n    if (payload.error) {\n      setError(`Payment failed ${payload.error.message}`);\n      setProcessing(false);\n    } else {\n      setError(null);\n      setProcessing(false);\n      setSucceeded(true);\n    }\n  };\n\n  return (\n    <form id=\"payment-form\" onSubmit={handleSubmit}>\n      <CardElement id=\"card-element\" options={cardStyle} onChange={handleChange} />\n      <button\n        disabled={processing || disabled || succeeded}\n        id=\"submit\"\n      >\n        <span id=\"button-text\">\n          {processing ? (\n            <div className=\"spinner\" id=\"spinner\"></div>\n          ) : (\n            \"Pay\"\n          )}\n        </span>\n      </button>\n      {/* Show any error that happens when processing the payment */}\n      {error && (\n        <div className=\"card-error\" role=\"alert\">\n          {error}\n        </div>\n      )}\n      {/* Show a success message upon completion */}\n      <p className={succeeded ? \"result-message\" : \"result-message hidden\"}>\n        Payment succeeded, see the result in your\n        <a\n          href={`https://dashboard.stripe.com/test/payments`}\n        >\n          {\" \"}\n          Stripe dashboard.\n        </a> Refresh the page to pay again.\n      </p>\n    </form>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}